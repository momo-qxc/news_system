"use strict";(self["webpackChunknewsmobile"]=self["webpackChunknewsmobile"]||[]).push([[961],{7961:function(t,i,e){e.r(i),e.d(i,{default:function(){return u}});var s=function(){var t=this,i=t._self._c;return i("div",{staticClass:"traffic-container"},[i("div",{staticClass:"header"},[i("van-nav-bar",{staticClass:"nav-header",attrs:{title:"地铁线路图"},scopedSlots:t._u([{key:"right",fn:function(){return[i("div",{staticClass:"city-selector",on:{click:function(i){t.showCityPicker=!0}}},[i("span",[t._v(t._s(t.currentCity))]),i("van-icon",{attrs:{name:"arrow-down",size:"12"}})],1)]},proxy:!0}])})],1),i("div",{staticClass:"subway-container",attrs:{id:"subway-container"}}),i("van-popup",{attrs:{position:"bottom",round:""},model:{value:t.showCityPicker,callback:function(i){t.showCityPicker=i},expression:"showCityPicker"}},[i("van-picker",{attrs:{"show-toolbar":"",title:"选择城市",columns:t.subwayCities,"value-key":"name"},on:{confirm:t.onCityConfirm,cancel:function(i){t.showCityPicker=!1}}})],1),i("van-tabbar",{attrs:{"active-color":"#e60012",route:""},model:{value:t.active,callback:function(i){t.active=i},expression:"active"}},[i("van-tabbar-item",{attrs:{icon:"home-o",to:"/"}},[t._v("首页")]),i("van-tabbar-item",{attrs:{icon:"location-o",to:"/life"}},[t._v("生活")]),i("van-tabbar-item",{attrs:{icon:"guide-o",to:"/traffic"}},[t._v("交通")]),i("van-tabbar-item",{attrs:{icon:"user-o",to:"/my"}},[t._v("我的")])],1)],1)},a=[],n=(e(8111),e(116),{name:"TrafficView",data(){return{active:2,currentCity:"厦门",currentCityCode:"",showCityPicker:!1,subway:null,subwayCities:[]}},mounted(){this.initSubwayCities(),this.$nextTick(()=>{this.autoSelectCityByLocation()})},methods:{initSubwayCities(){if("undefined"!==typeof BMapSub&&BMapSub.SubwayCitiesList){this.subwayCities=BMapSub.SubwayCitiesList;const t=this.subwayCities.find(t=>t.name===this.currentCity);t&&(this.currentCityCode=t.citycode)}},autoSelectCityByLocation(){if("undefined"!==typeof BMapGL){const t=new BMapGL.Geolocation;t.getCurrentPosition(i=>{if(0===t.getStatus()&&i.address&&i.address.city){let t=i.address.city.replace("市",""),e=this.subwayCities.find(i=>i.name===t);e||(e=this.subwayCities.find(i=>i.name.includes(t)||t.includes(i.name))),e&&(this.currentCity=e.name,this.currentCityCode=e.citycode),this.initSubway()}else this.initSubway()},{enableHighAccuracy:!0,timeout:5e3})}else this.initSubway()},initSubway(){if(!this.currentCityCode){const t=this.subwayCities.find(t=>t.name===this.currentCity);t?this.currentCityCode=t.citycode:this.subwayCities.length>0&&(this.currentCity=this.subwayCities[0].name,this.currentCityCode=this.subwayCities[0].citycode)}this.currentCityCode&&(this.subway=new BMapSub.Subway("subway-container",this.currentCityCode),this.subway.setZoom(.4))},onCityConfirm(t){this.currentCity=t.name,this.currentCityCode=t.citycode,this.showCityPicker=!1,this.$nextTick(()=>{this.initSubway()})}}}),o=n,c=e(1656),r=(0,c.A)(o,s,a,!1,null,"8855f9fa",null),u=r.exports}}]);
//# sourceMappingURL=961.d20a7f15.js.map